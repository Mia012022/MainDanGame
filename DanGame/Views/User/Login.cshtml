@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model dynamic;
@{
    ViewBag.Title = "Login";
    Layout = "_Layout";
}

<div class="d-flex justify-content-center align-items-center" style="height: 100vh; padding-top: 2rem;">
        <div class="border container d-flex flex-column">
            <br>
        <form method="post" asp-controller="User" asp-action="Login">
            <input id="redirectTo" name="redirectTo" value="@(Model?.redirectTo != null ? $"{System.Web.HttpUtility.UrlDecode(Model.redirectTo)}" : "")" hidden>
                <div class="p-2">
                    <label for="useremail">帳號：</label>
                <input type="text" id="useremail" name="useremail" pattern="[a-zA-Z0-9._%+-]+@@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" title="請輸入有效的電子郵件地址，如 example@example.com"
                        required>
                </div>
                <div class="p-2">
                    <label for="password">密碼：</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <!-- 
                    <form id="loginForm">
                <div class="p-2">
                    <label for="account">帳號：</label>
                    <input type="text" id="account" name="account" pattern="\w+([.-]?\w+)*@@\w+([.-]?\w+)*(\.\w{2,3})+" required>
                </div>
                <div class="p-2">
                    <label for="password">密碼：</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <div class="p-2">
                    <label for="">驗證碼：</label>
                    <input type="text" name="" id="">
                </div>
                <div class="p-2">
                    <img id="captcha-img" class="" src="https://picsum.photos/200/100?random=" alt="">
                    <button class="btn btn-primary" onclick="refreshCaptcha()">重新整理</button>
                </div>
                <div class="p-2">
                    <a href="./forget_pw.html">忘記密碼</a>
                    <a href="./register.html">註冊</a>
                </div>
                <div class="p-2">
                    <button type="button" class="btn btn-primary" onclick="submitLogin()">登入</button>
                </div>
                </form>
                -->
                <div class="p-2">
                    <a href="./forget_pw.html" style="padding-left: 100px;">忘記密碼</a>
                    <a asp-controller="User" asp-action="Register" style="padding-left: 30px;">註冊</a>
                </div>
                <div class="p-2">
                    <button type="submit" class="btn btn-primary">登入</button>
                </div>
            </form>
            @if (ViewBag.ErrorMessage != null)
            {
                <div>
                    <span style="color:red;">@ViewBag.ErrorMessage</span>
                </div>
            }
        </div>
    </div>
    <script>
        // function validateForm() {
        //     var accountInput = document.getElementById('account');
        //     var pattern = new RegExp(accountInput.pattern);
        //     if (!pattern.test(accountInput.value)) {
        //         alert('請輸入有效的電子郵件地址！');
        //         return false;
        //     }
        //     // 模擬驗證成功，進行頁面跳轉
        //     window.location.href = './account_set.html';
        //     return false; // 阻止表單默認提交行為
        // }

        /*
        function validateForm() {
            var accountInput = document.getElementById('account');
            var pattern = new RegExp(accountInput.pattern);
            if (!pattern.test(accountInput.value)) {
                alert('請輸入有效的電子郵件地址！');
                return false;
            }

            // AJAX 提交表單
            var account = document.getElementById('account').value;
            var password = document.getElementById('password').value;

            $.ajax({
                url: '/login', // 後端處理登錄的API路徑
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ account: account, password: password }),
                success: function (response) {
                    if (response.success) {
                        window.location.href = './account_set.html';
                    } else {
                        alert('帳號或密碼錯誤');
                    }
                },
                error: function () {
                    alert('登錄過程中出現錯誤');
                }
            });

            return false; // 阻止表單默認提交
        }
        */

        // function refreshCaptcha() {
        //     var randomNumber = Math.floor(Math.random() * 1000); // 生成一個 0 到 999 的隨機數
        //     var captchaImg = document.getElementById("captcha-img");
        //     captchaImg.src = "https://picsum.photos/200/100?random=" + randomNumber; // 使用 Picsum 圖片服務生成亂數圖片
        // }
    </script>
